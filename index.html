<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Market</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <h1>Business Stock Market</h1>
        <button id="login-btn" class="btn">Login</button>
        <button id="signup-btn" class="btn">Sign Up</button>
    </header>
    
    <main>
        <!-- Stock Chart Section -->
        <section id="chart-section" class="card">
            <h2>Stock Price Chart</h2>
            <canvas id="stockChart"></canvas>
        </section>

        <!-- Market Section -->
        <section id="market" class="card">
            <h2>Available Stocks</h2>
            <ul id="stock-list">
                <li>LennonMart - <span class="price">100 Diamonds</span> <button class="buy-btn" data-stock="LennonMart">Buy</button></li>
                <li>Lennon Goods and Services - <span class="price">200 Diamonds</span> <button class="buy-btn" data-stock="Lennon Goods and Services">Buy</button></li>
                <li>Meme Station - <span class="price">150 Emeralds</span> <button class="buy-btn" data-stock="Meme Station">Buy</button></li>
                <li>Memesmith - <span class="price">250 Emeralds</span> <button class="buy-btn" data-stock="Memesmith">Buy</button></li>
            </ul>
        </section>

        <section id="portfolio" class="card">
            <h2>Your Portfolio</h2>
            <ul id="portfolio-list">
                <li>No stocks purchased yet.</li>
            </ul>
        </section>
        
        <!-- Login Form -->
        <section id="login-form" class="card" style="display: none;">
            <h2>Login</h2>
            <form id="login-form-element">
                <label for="login-username">Username:</label>
                <input type="text" id="login-username" name="login-username" required>
                <label for="login-password">Password:</label>
                <input type="password" id="login-password" name="login-password" required>
                <button type="submit" class="btn">Login</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Business Stock Market. All rights reserved.</p>
    </footer>

    <script>
        $(document).ready(function() {
            // Chart.js data and config
            const ctx = document.getElementById('stockChart').getContext('2d');
            const stockData = {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                datasets: [{
                    label: 'LennonMart Stock Price',
                    data: [100, 120, 140, 130, 150, 160, 170],
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                    fill: false
                },
                {
                    label: 'Meme Station Stock Price',
                    data: [150, 160, 180, 170, 200, 210, 220],
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1,
                    fill: false
                }]
            };
            const config = {
                type: 'line',
                data: stockData,
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            beginAtZero: true
                        },
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            };
            const stockChart = new Chart(ctx, config);

            // Simulate buying stock and updating the chart
            $('.buy-btn').click(function() {
                const stock = $(this).data('stock');
                alert('You bought stock in ' + stock);

                // Simulate stock price change by adding or subtracting a random value
                const randomChange = Math.floor(Math.random() * 21) - 10; // Random change between -10 and +10

                if (stock === 'LennonMart') {
                    // Add or subtract the random change to LennonMart stock price
                    stockData.datasets[0].data.push(stockData.datasets[0].data[stockData.datasets[0].data.length - 1] + randomChange);
                    stockData.labels.push('Aug'); // Add new label for the new month
                } else if (stock === 'Meme Station') {
                    // Add or subtract the random change to Meme Station stock price
                    stockData.datasets[1].data.push(stockData.datasets[1].data[stockData.datasets[1].data.length - 1] + randomChange);
                    stockData.labels.push('Aug'); // Add new label for the new month
                }

                // Update the chart with the new data
                stockChart.update();

                // Update portfolio
                $('#portfolio-list').append('<li>' + stock + ' - 1 share</li>');
            });

            // Check login status on page load
            if(localStorage.getItem('username')) {
                $('#user-info').text('Logged in as ' + localStorage.getItem('username'));
            }

            // Login form handling
            $('#login-form-element').submit(function(e) {
                e.preventDefault();
                const username = $('#login-username').val();
                const password = $('#login-password').val();
                if (localStorage.getItem(username) && localStorage.getItem(username) === password) {
                    localStorage.setItem('username', username);
                    alert('Login successful!');
                } else {
                    alert('Invalid login credentials!');
                }
            });
        });
    </script>
</body>
</html>
